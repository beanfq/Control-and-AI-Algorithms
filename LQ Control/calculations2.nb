(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     49348,       1504]
NotebookOptionsPosition[     45755,       1381]
NotebookOutlinePosition[     46098,       1396]
CellTagsIndexPosition[     46055,       1393]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"dk", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"b1", "-", "d1"}], ")"}], "k"}], "-", 
    RowBox[{"Y", " ", "a", " ", 
     RowBox[{"(", 
      RowBox[{"k", "-", "kV"}], ")"}]}], "+", "kin"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ds", " ", "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"b2", "-", "d2"}], ")"}], "s"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dv", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "d3"}], " ", "v"}], " ", "+", " ", 
    RowBox[{"a", 
     RowBox[{"(", 
      RowBox[{"k", "-", "kV"}], ")"}]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6939923782023354`*^9, 3.6939924123497496`*^9}, {
  3.6939928433848486`*^9, 3.6939928438939*^9}, {3.693993381528658*^9, 
  3.69399338234974*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"dk", "\[Equal]", "0"}], ",", 
       RowBox[{"ds", "\[Equal]", "0"}], ",", 
       RowBox[{"dv", "\[Equal]", "0"}]}], "}"}], "/.", 
     RowBox[{"{", 
      RowBox[{"kin", "\[Rule]", "0"}], "}"}]}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"k", ",", "s", ",", "v"}], "}"}]}], "]"}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.6939924167041855`*^9, 3.6939924514526596`*^9}, {
  3.6939925371782312`*^9, 3.693992540040518*^9}, {3.693993384577963*^9, 
  3.693993435609065*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"k", "\[Rule]", 
     FractionBox[
      RowBox[{"a", " ", "kV", " ", "Y"}], 
      RowBox[{
       RowBox[{"-", "b1"}], "+", "d1", "+", 
       RowBox[{"a", " ", "Y"}]}]]}], ",", 
    RowBox[{"s", "\[Rule]", "0"}], ",", 
    RowBox[{"v", "\[Rule]", 
     FractionBox[
      RowBox[{"a", " ", 
       RowBox[{"(", 
        RowBox[{"b1", "-", "d1"}], ")"}], " ", "kV"}], 
      RowBox[{"d3", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "b1"}], "+", "d1", "+", 
         RowBox[{"a", " ", "Y"}]}], ")"}]}]]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.6939924519127054`*^9, 3.693992540818595*^9, 3.6939928485843687`*^9, {
   3.69399339174868*^9, 3.6939934361631207`*^9}}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"kster", " ", "=", " ", 
   RowBox[{"k", "+", " ", 
    FractionBox[
     RowBox[{"a", " ", "kV", " ", "Y"}], 
     RowBox[{
      RowBox[{"-", "b1"}], "+", "d1", "+", 
      RowBox[{"a", " ", "Y"}]}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sster", " ", "=", " ", "s"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vster", " ", "=", " ", 
   RowBox[{"v", " ", "+", 
    FractionBox[
     RowBox[{"a", " ", 
      RowBox[{"(", 
       RowBox[{"b1", "-", "d1"}], ")"}], " ", "kV"}], 
     RowBox[{"d3", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "b1"}], "+", "d1", "+", 
        RowBox[{"a", " ", "Y"}]}], ")"}]}]]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6939924572082353`*^9, 3.6939925064531593`*^9}, {
  3.693992546944208*^9, 3.6939925524017534`*^9}, {3.693992673829895*^9, 
  3.693992676552167*^9}, {3.6939927873672476`*^9, 3.693992790212532*^9}, {
  3.6939928551500254`*^9, 3.693992865958106*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"dkster", " ", "=", " ", 
  RowBox[{
   RowBox[{"dk", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"k", "\[Rule]", "kster"}], ",", 
      RowBox[{"s", "\[Rule]", "sster"}], ",", 
      RowBox[{"v", "\[Rule]", "vster"}]}], "}"}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"dsster", " ", "=", " ", 
  RowBox[{
   RowBox[{"ds", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"k", "\[Rule]", "kster"}], ",", 
      RowBox[{"s", "\[Rule]", "sster"}], ",", 
      RowBox[{"v", "\[Rule]", "vster"}]}], "}"}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"dvster", " ", "=", " ", 
  RowBox[{
   RowBox[{"dv", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"k", "\[Rule]", "kster"}], ",", 
      RowBox[{"s", "\[Rule]", "sster"}], ",", 
      RowBox[{"v", "\[Rule]", "vster"}]}], "}"}]}], "//", 
   "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.693992279716488*^9, 3.693992339584474*^9}, {
  3.6939923769042053`*^9, 3.6939923770522203`*^9}, {3.6939926799635086`*^9, 
  3.6939927326787796`*^9}, {3.6939934722947335`*^9, 3.693993481046609*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"b1", " ", "k"}], "-", 
  RowBox[{"d1", " ", "k"}], "+", "kin", "-", 
  RowBox[{"a", " ", "k", " ", "Y"}]}]], "Output",
 CellChangeTimes->{3.693993481478652*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"b2", "-", "d2"}], ")"}], " ", "s"}]], "Output",
 CellChangeTimes->{3.6939934814816523`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"a", " ", "k"}], "-", 
  RowBox[{"d3", " ", "v"}]}]], "Output",
 CellChangeTimes->{3.6939934814846525`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"dkster", "\[Equal]", "0"}], "&&", 
     RowBox[{"dsster", "\[Equal]", "0"}], "&&", 
     RowBox[{"dvster", "\[Equal]", "0"}]}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"k", ",", "s", ",", "v"}], "}"}]}], "]"}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.6939927378082924`*^9, 3.6939927833198433`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"k", "\[Rule]", "0"}], ",", 
    RowBox[{"s", "\[Rule]", "0"}], ",", 
    RowBox[{"v", "\[Rule]", "0"}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.6939927684503565`*^9, 3.6939927944249535`*^9}, {
  3.69399285879839*^9, 3.693992869623472*^9}}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"kin", " ", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b1", " ", "=", " ", "0.02"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d2", " ", "=", " ", "0.02"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b2", " ", "=", " ", "0.01"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d1", " ", "=", " ", "0.01"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d3", " ", "=", " ", "0.01"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a", " ", "=", " ", "0.001"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kV", " ", "=", " ", "2000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Y", " ", "=", " ", "100"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"k0", " ", "=", " ", "1000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s0", " ", "=", " ", "500"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"v0", " ", "=", " ", "20"}], ";"}]}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"(", 
   RowBox[{"A1", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"b1", "-", "d1", "-", 
         RowBox[{"Y", "*", "a"}]}], ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"b2", "-", "d2"}], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"a", ",", "0", ",", 
        RowBox[{"-", "d3"}]}], "}"}]}], "}"}]}], ")"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(", 
   RowBox[{"B1", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "1", "}"}], ",", 
      RowBox[{"{", "0", "}"}], ",", 
      RowBox[{"{", "0", "}"}]}], "}"}]}], ")"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(", 
   RowBox[{"C1", " ", "=", " ", 
    RowBox[{"IdentityMatrix", "[", "3", "]"}]}], ")"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(", 
   RowBox[{"D1", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "0", "}"}], ",", 
      RowBox[{"{", "0", "}"}], ",", 
      RowBox[{"{", "0", "}"}]}], "}"}]}], ")"}], "//", 
  "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.693993996877187*^9, 3.6939940857640743`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "0.09000000000000001`"}], "0", "0"},
     {"0", 
      RowBox[{"-", "0.01`"}], "0"},
     {"0.001`", "0", 
      RowBox[{"-", "0.01`"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.6939940861151094`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1"},
     {"0"},
     {"0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.6939940861181097`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0"},
     {"0", "1", "0"},
     {"0", "0", "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.69399408612111*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0"},
     {"0"},
     {"0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.69399408612411*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"systeem1", " ", "=", " ", 
  RowBox[{"StateSpaceModel", "[", 
   RowBox[{"{", 
    RowBox[{"A1", ",", "B1", ",", "C1", ",", "D1"}], "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.693994089430441*^9, 3.6939941066861663`*^9}}],

Cell[BoxData[
 TemplateBox[{
  RowBox[{"-", "0.09000000000000001`"}],"0","0","1","0",
   RowBox[{"-", "0.01`"}],"0","0","0.001`","0",RowBox[{"-", "0.01`"}],"0","1",
   "0","0","0","0","1","0","0","0","0","1","0",InterpretationBox[
   "\[InvisibleSpace]", None],{
   StateSpaceModel, {
    False, False, {
     False, False}}, {$CellContext`stname1, $CellContext`stname2, \
$CellContext`stname3}, {{Control`CommonDump`$DUMMY$}, {
     Control`CommonDump`$DUMMY$, Control`CommonDump`$DUMMY$, 
      Control`CommonDump`$DUMMY$}, {
     Control`CommonDump`$DUMMY$, Control`CommonDump`$DUMMY$, 
      Control`CommonDump`$DUMMY$}}, Identity, Automatic, 1, 3, 3, 1, {}, {
    False, False}, False, Automatic, None, Automatic},{}},
  "StateSpaceModelFull",
  BaseStyle->{NumberMarks -> False},
  DisplayFunction->(TagBox[
    SubsuperscriptBox[
     RowBox[{"(", 
       GridBox[{{#, #2, #3, #4}, {#5, #6, #7, #8}, {#9, #10, #11, #12}, {#13, \
#14, #15, #16}, {#17, #18, #19, #20}, {#21, #22, #23, #24}}, 
        AllowedDimensions -> {4, 6}, AutoDelete -> False, 
        AllowScriptLevelChange -> False, ColumnAlignments -> {Center}, 
        BaseStyle -> {Deployed -> False}, GridBoxItemStyle -> {}, 
        GridBoxDividers -> {"Rows" -> {False, False, False, 
            Directive[
             GrayLevel[0], 
             GrayLevel[0.6]], {False}, False}, 
          "Columns" -> {False, False, False, 
            Directive[
             GrayLevel[0], 
             GrayLevel[0.6]], {False}, False}}, 
        GridBoxBackground -> {"Rows" -> {{
             GrayLevel[1], 
             RGBColor[0.8, 0.9, 0.9]}}}], ")"}], #25, 
     ButtonBox[
      GraphicsBox[{
        RGBColor[0.8, 0.85, 0.85], 
        EdgeForm[
         RGBColor[0.6, 0.7, 0.7]], 
        RectangleBox[{0, 0}, RoundingRadius -> Offset[2.5]], 
        InsetBox[
         StyleBox[
         "\[ScriptCapitalS]", Control`NonlinearModelsDump`LineColor -> 
          GrayLevel[0], Control`NonlinearModelsDump`FrontFaceColor -> 
          GrayLevel[0], Control`NonlinearModelsDump`BackFaceColor -> 
          GrayLevel[0], GraphicsColor -> GrayLevel[0], FontSize -> 12, 
          FontColor -> GrayLevel[0]], {0.5, 0.5}]}, ImageSize -> 20], 
      ButtonFunction :> Control`Typesetting`SystemsModelTypesetToggle[
        ButtonNotebook[], FE`CMObj], Evaluator -> Automatic, Appearance -> 
      None], MultilineFunction -> None], 
    EventHandlerTag[{"MouseEntered" :> {FE`CMObj = MathLink`CallFrontEnd[
          FrontEnd`Value[
           FEPrivate`Self[]]]}, PassEventsDown -> True, PassEventsUp -> 
      True}]]& ),
  InterpretationFunction->(RowBox[{"StateSpaceModel", "[", 
     RowBox[{"{", 
       RowBox[{"{", 
         RowBox[{"{", 
           TemplateSlotSequence[{1, 3}, ","], "}"}], ",", 
         RowBox[{"{", 
           TemplateSlotSequence[{5, 7}, ","], "}"}], ",", 
         RowBox[{"{", 
           TemplateSlotSequence[{9, 11}, ","], "}"}], "}"}], ",", 
       RowBox[{"{", 
         RowBox[{"{", 
           TemplateSlotSequence[{4, 4}, ","], "}"}], ",", 
         RowBox[{"{", 
           TemplateSlotSequence[{8, 8}, ","], "}"}], ",", 
         RowBox[{"{", 
           TemplateSlotSequence[{12, 12}, ","], "}"}], "}"}], ",", 
       RowBox[{"{", 
         RowBox[{"{", 
           TemplateSlotSequence[{13, 15}, ","], "}"}], ",", 
         RowBox[{"{", 
           TemplateSlotSequence[{17, 19}, ","], "}"}], ",", 
         RowBox[{"{", 
           TemplateSlotSequence[{21, 23}, ","], "}"}], "}"}], ",", 
       RowBox[{"{", 
         RowBox[{"{", 
           TemplateSlotSequence[{16, 16}, ","], "}"}], ",", 
         RowBox[{"{", 
           TemplateSlotSequence[{20, 20}, ","], "}"}], ",", 
         RowBox[{"{", 
           TemplateSlotSequence[{24, 24}, ","], "}"}], "}"}], "}"}], ",", 
     "SamplingPeriod", "->", 
     RowBox[{#25}], ",", "SystemsModelLabels", "->", "None", "]"}]& ),
  Tooltip->StateSpaceModel]], "Output",
 CellChangeTimes->{3.6939941073962374`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Eigenvalues", "[", "A1", "]"}]], "Input",
 CellChangeTimes->{{3.6939941221297107`*^9, 3.6939941284483423`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "0.09000000000000001`"}], ",", 
   RowBox[{"-", "0.01`"}], ",", 
   RowBox[{"-", "0.01`"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6939941289323907`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ControllableModelQ", "[", "systeem1", "]"}]], "Input",
 CellChangeTimes->{{3.69399431014651*^9, 3.693994320894585*^9}}],

Cell[BoxData[
 TemplateBox[{
  "LyapunovSolve","meig",
   "\"Matrix with multiple eigenvalues encountered. The solution may be \
inaccurate or may not exist.\"",2,97,13,17607212627329856836,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.693994321393635*^9}],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{3.693994321395635*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"P", "=", 
    RowBox[{"ControllabilityMatrix", "[", "systeem1", "]"}]}], ")"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.6939943239118867`*^9, 3.6939943404165373`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", 
      RowBox[{"-", "0.09000000000000001`"}], "0.008100000000000001`"},
     {"0", "0.`", "0.`"},
     {"0", "0.001`", 
      RowBox[{"-", "0.0001`"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.6939943302315187`*^9, 3.6939943405105467`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"T1", " ", "=", " ", 
    RowBox[{"Transpose", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"P", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"P", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
       RowBox[{"Cross", "[", 
        RowBox[{
         RowBox[{"P", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"P", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "]"}]}], "}"}], "]"}]}],
    ")"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.6939943959210873`*^9, 3.693994451148609*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", 
      RowBox[{"-", "0.09000000000000001`"}], "0.`"},
     {"0", "0.`", 
      RowBox[{"-", "0.001`"}]},
     {"0", "0.001`", "0.`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.6939944453080254`*^9, 3.6939944514766417`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"(", 
   RowBox[{"AT1", " ", "=", " ", 
    RowBox[{"T1", ".", "A1", ".", 
     RowBox[{"Inverse", "[", "T1", "]"}]}]}], ")"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(", 
   RowBox[{"BT1", " ", "=", " ", 
    RowBox[{"T1", ".", "B1"}]}], ")"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(", 
   RowBox[{"Z", " ", "=", " ", 
    RowBox[{
     RowBox[{"Inverse", "[", "T1", "]"}], ".", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "k", "}"}], ",", 
       RowBox[{"{", "s", "}"}], ",", 
       RowBox[{"{", "v", "}"}]}], "}"}]}]}], ")"}], "//", 
  "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.693994454447939*^9, 3.6939945407345667`*^9}, {
  3.6939945786533585`*^9, 3.693994578859379*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "0.09000000000000001`"}], "0.`", 
      RowBox[{"-", "7.200000000000001`"}]},
     {
      RowBox[{"-", "1.`*^-6"}], 
      RowBox[{"-", "0.01`"}], 
      RowBox[{"-", "0.00009`"}]},
     {"0.`", "0.`", 
      RowBox[{"-", "0.01`"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.693994541052599*^9, 3.6939945792304163`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1.`"},
     {"0.`"},
     {"0.`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.693994541052599*^9, 3.6939945792354164`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"1.`", " ", "k"}], "+", 
       RowBox[{"90.00000000000001`", " ", "v"}]}]},
     {
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"1000.`", " ", "v"}]}]},
     {
      RowBox[{"0.`", "\[VeryThinSpace]", "-", 
       RowBox[{"1000.`", " ", "s"}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.693994541052599*^9, 3.693994579239417*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"(", 
   RowBox[{"T2", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "}"}]}], ")"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(", 
   RowBox[{"AT2", " ", "=", " ", 
    RowBox[{"T2", ".", "A1", ".", 
     RowBox[{"Inverse", "[", "T2", "]"}]}]}], ")"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(", 
   RowBox[{"BT2", " ", "=", " ", 
    RowBox[{"T2", ".", "B1"}]}], ")"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(", 
   RowBox[{"Z", " ", "=", " ", 
    RowBox[{
     RowBox[{"Inverse", "[", "T2", "]"}], ".", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "k", "}"}], ",", 
       RowBox[{"{", "s", "}"}], ",", 
       RowBox[{"{", "v", "}"}]}], "}"}]}]}], ")"}], "//", 
  "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.6939945467681704`*^9, 3.6939945921137047`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0"},
     {"0", "0", "1"},
     {"0", "1", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.6939945924047337`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "0.09000000000000001`"}], "0.`", "0.`"},
     {"0.001`", 
      RowBox[{"-", "0.01`"}], "0.`"},
     {"0.`", "0.`", 
      RowBox[{"-", "0.01`"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.6939945924067335`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1"},
     {"0"},
     {"0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.693994592410734*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"k"},
     {"v"},
     {"s"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.6939945924137344`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Eigenvalues", "[", "A1", "]"}]], "Input",
 CellChangeTimes->{{3.6939946090163946`*^9, 3.693994613586851*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "0.09000000000000001`"}], ",", 
   RowBox[{"-", "0.01`"}], ",", 
   RowBox[{"-", "0.01`"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6939946140168943`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"K", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"k1", ",", "k2"}], "}"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"eig", " ", "=", " ", 
  RowBox[{"Eigenvalues", "[", 
   RowBox[{
    RowBox[{"AT2", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"1", ";;", "2"}], ",", 
       RowBox[{"1", ";;", "2"}]}], "]"}], "]"}], "+", 
    RowBox[{
     RowBox[{"BT2", "[", 
      RowBox[{"[", 
       RowBox[{"1", ";;", "2"}], "]"}], "]"}], ".", "K"}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.693995663243807*^9, 3.6939956952460065`*^9}, {
  3.693995792240705*^9, 3.693995825341015*^9}, {3.693996003532832*^9, 
  3.6939960289703755`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0.5`", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "0.1`"}], "+", 
      RowBox[{"1.`", " ", "k1"}], "-", 
      SqrtBox[
       RowBox[{"0.006400000000000001`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.16`", " ", "k1"}], "+", 
        RowBox[{"1.`", " ", 
         SuperscriptBox["k1", "2"]}], "+", 
        RowBox[{"0.004`", " ", "k2"}]}]]}], ")"}]}], ",", 
   RowBox[{"0.5`", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "0.1`"}], "+", 
      RowBox[{"1.`", " ", "k1"}], "+", 
      SqrtBox[
       RowBox[{"0.006400000000000001`", "\[VeryThinSpace]", "-", 
        RowBox[{"0.16`", " ", "k1"}], "+", 
        RowBox[{"1.`", " ", 
         SuperscriptBox["k1", "2"]}], "+", 
        RowBox[{"0.004`", " ", "k2"}]}]]}], ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6939956959650784`*^9, {3.6939958083673177`*^9, 3.6939958258960705`*^9}, {
   3.6939960040438833`*^9, 3.6939960292644053`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Reduce", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Re", "[", 
      RowBox[{"eig", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "]"}], "==", 
     RowBox[{"-", "1"}]}], "&&", " ", 
    RowBox[{
     RowBox[{"Re", "[", 
      RowBox[{"eig", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "]"}], "==", 
     RowBox[{"-", "1"}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"k1", ",", "k2"}], "}"}], ",", "Reals"}], "]"}]], "Input",
 CellChangeTimes->{{3.6939956980652885`*^9, 3.6939957134658284`*^9}, {
  3.6939957455720387`*^9, 3.693995763398821*^9}, {3.69399582829331*^9, 
  3.6939958731517954`*^9}, {3.6939959122407036`*^9, 3.693995914415921*^9}}],

Cell[BoxData[
 TemplateBox[{
  "Reduce","ratnz",
   "\"Reduce was unable to solve the system with inexact coefficients. The \
answer was obtained by solving a corresponding exact system and numericizing \
the result.\"",2,189,44,17607212627329856836,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.693995874020882*^9, 3.6939959148539653`*^9, {3.6939960095584345`*^9, 
   3.6939960317296515`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"k1", "\[Equal]", 
   RowBox[{"-", "1.9`"}]}], "&&", 
  RowBox[{"k2", "\[Equal]", 
   RowBox[{"-", "980.1`"}]}]}]], "Output",
 CellChangeTimes->{
  3.6939958741108913`*^9, 3.6939959149149714`*^9, {3.693996009633442*^9, 
   3.6939960317986584`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             ,

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"c1", "c2", "0"},
     {"0", "0", "c3"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.6939989386815243`*^9, {3.693998972884944*^9, 3.6939989891005654`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0"},
     {"0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.6939989386815243`*^9, {3.693998972884944*^9, 3.693998989106566*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"systeem2", " ", "=", " ", 
  RowBox[{"StateSpaceModel", "[", 
   RowBox[{"{", 
    RowBox[{"A2", ",", "B2", ",", "C2", ",", "D2"}], "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6939989446501207`*^9, 3.693998976772333*^9}}],

Cell[BoxData[
 TemplateBox[{
  RowBox[{"-", "0.09000000000000001`"}],"0","0","1","0",
   RowBox[{"-", "0.01`"}],"0","0","0.001`","0",RowBox[{"-", "0.01`"}],"0",
   "0.5`","0.4`","0","0","0","0","2","0",InterpretationBox[
   "\[InvisibleSpace]", None],{
   StateSpaceModel, {
    False, False, {
     False, False}}, {$CellContext`stname1, $CellContext`stname2, \
$CellContext`stname3}, {{Control`CommonDump`$DUMMY$}, {
     Control`CommonDump`$DUMMY$, Control`CommonDump`$DUMMY$}, {
     Control`CommonDump`$DUMMY$, Control`CommonDump`$DUMMY$, 
      Control`CommonDump`$DUMMY$}}, Identity, Automatic, 1, 2, 3, 1, {}, {
    False, False}, False, Automatic, None, Automatic},{}},
  "StateSpaceModelFull",
  BaseStyle->{NumberMarks -> False},
  DisplayFunction->(TagBox[
    SubsuperscriptBox[
     RowBox[{"(", 
       GridBox[{{#, #2, #3, #4}, {#5, #6, #7, #8}, {#9, #10, #11, #12}, {#13, \
#14, #15, #16}, {#17, #18, #19, #20}}, AllowedDimensions -> {4, 5}, 
        AutoDelete -> False, AllowScriptLevelChange -> False, 
        ColumnAlignments -> {Center}, BaseStyle -> {Deployed -> False}, 
        GridBoxItemStyle -> {}, 
        GridBoxDividers -> {"Rows" -> {False, False, False, 
            Directive[
             GrayLevel[0], 
             GrayLevel[0.6]], {False}, False}, 
          "Columns" -> {False, False, False, 
            Directive[
             GrayLevel[0], 
             GrayLevel[0.6]], {False}, False}}, 
        GridBoxBackground -> {"Rows" -> {{
             GrayLevel[1], 
             RGBColor[0.8, 0.9, 0.9]}}}], ")"}], #21, 
     ButtonBox[
      GraphicsBox[{
        RGBColor[0.8, 0.85, 0.85], 
        EdgeForm[
         RGBColor[0.6, 0.7, 0.7]], 
        RectangleBox[{0, 0}, RoundingRadius -> Offset[2.5]], 
        InsetBox[
         StyleBox[
         "\[ScriptCapitalS]", Control`NonlinearModelsDump`LineColor -> 
          GrayLevel[0], Control`NonlinearModelsDump`FrontFaceColor -> 
          GrayLevel[0], Control`NonlinearModelsDump`BackFaceColor -> 
          GrayLevel[0], GraphicsColor -> GrayLevel[0], FontSize -> 12, 
          FontColor -> GrayLevel[0]], {0.5, 0.5}]}, ImageSize -> 20], 
      ButtonFunction :> Control`Typesetting`SystemsModelTypesetToggle[
        ButtonNotebook[], FE`CMObj], Evaluator -> Automatic, Appearance -> 
      None], MultilineFunction -> None], 
    EventHandlerTag[{"MouseEntered" :> {FE`CMObj = MathLink`CallFrontEnd[
          FrontEnd`Value[
           FEPrivate`Self[]]]}, PassEventsDown -> True, PassEventsUp -> 
      True}]]& ),
  InterpretationFunction->(RowBox[{"StateSpaceModel", "[", 
     RowBox[{"{", 
       RowBox[{"{", 
         RowBox[{"{", 
           TemplateSlotSequence[{1, 3}, ","], "}"}], ",", 
         RowBox[{"{", 
           TemplateSlotSequence[{5, 7}, ","], "}"}], ",", 
         RowBox[{"{", 
           TemplateSlotSequence[{9, 11}, ","], "}"}], "}"}], ",", 
       RowBox[{"{", 
         RowBox[{"{", 
           TemplateSlotSequence[{4, 4}, ","], "}"}], ",", 
         RowBox[{"{", 
           TemplateSlotSequence[{8, 8}, ","], "}"}], ",", 
         RowBox[{"{", 
           TemplateSlotSequence[{12, 12}, ","], "}"}], "}"}], ",", 
       RowBox[{"{", 
         RowBox[{"{", 
           TemplateSlotSequence[{13, 15}, ","], "}"}], ",", 
         RowBox[{"{", 
           TemplateSlotSequence[{17, 19}, ","], "}"}], "}"}], ",", 
       RowBox[{"{", 
         RowBox[{"{", 
           TemplateSlotSequence[{16, 16}, ","], "}"}], ",", 
         RowBox[{"{", 
           TemplateSlotSequence[{20, 20}, ","], "}"}], "}"}], "}"}], ",", 
     "SamplingPeriod", "->", 
     RowBox[{#21}], ",", "SystemsModelLabels", "->", "None", "]"}]& ),
  Tooltip->StateSpaceModel]], "Output",
 CellChangeTimes->{{3.6939989772723827`*^9, 3.693998990918747*^9}, 
   3.6939993960442553`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ObservabilityMatrix", "[", "systeem2", "]"}], "//", 
  "MatrixRank"}]], "Input",
 CellChangeTimes->{{3.693998994376093*^9, 3.693999050438699*^9}}],

Cell[BoxData["3"], "Output",
 CellChangeTimes->{
  3.6939990022798834`*^9, {3.693999041821837*^9, 3.6939990508747425`*^9}}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"c1", " ", "=", " ", "0.5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"c2", " ", "=", " ", "0.4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"c3", " ", "=", " ", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Eigenvalues", "[", 
  RowBox[{"A2", "-", 
   RowBox[{"H", ".", "C2"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.6939993138450365`*^9, 3.6939993727609277`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"C3", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "c3"}], "}"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"D3", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"{", "0", "}"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"systeem3", " ", "=", " ", 
  RowBox[{"StateSpaceModel", "[", 
   RowBox[{"{", 
    RowBox[{"A2", ",", "B2", ",", "C3", ",", "D3"}], "}"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.694001238809621*^9, 3.6940012989626355`*^9}}],

Cell[BoxData[
 TemplateBox[{
  RowBox[{"-", "0.09000000000000001`"}],"0","0","1","0",
   RowBox[{"-", "0.01`"}],"0","0","0.001`","0",RowBox[{"-", "0.01`"}],"0","0",
   "0","2","0",InterpretationBox["\[InvisibleSpace]", None],{
   StateSpaceModel, {
    False, False, {
     False, False}}, {$CellContext`stname1, $CellContext`stname2, \
$CellContext`stname3}, {{Control`CommonDump`$DUMMY$}, {
     Control`CommonDump`$DUMMY$}, {
     Control`CommonDump`$DUMMY$, Control`CommonDump`$DUMMY$, 
      Control`CommonDump`$DUMMY$}}, Identity, Automatic, 1, 1, 3, 1, {}, {
    False, False}, False, Automatic, None, Automatic},{}},
  "StateSpaceModelFull",
  BaseStyle->{NumberMarks -> False},
  DisplayFunction->(TagBox[
    SubsuperscriptBox[
     RowBox[{"(", 
       GridBox[{{#, #2, #3, #4}, {#5, #6, #7, #8}, {#9, #10, #11, #12}, {#13, \
#14, #15, #16}}, AllowedDimensions -> {4, 4}, AutoDelete -> False, 
        AllowScriptLevelChange -> False, ColumnAlignments -> {Center}, 
        BaseStyle -> {Deployed -> False}, GridBoxItemStyle -> {}, 
        GridBoxDividers -> {"Rows" -> {False, False, False, 
            Directive[
             GrayLevel[0], 
             GrayLevel[0.6]], {False}, False}, 
          "Columns" -> {False, False, False, 
            Directive[
             GrayLevel[0], 
             GrayLevel[0.6]], {False}, False}}, 
        GridBoxBackground -> {"Rows" -> {{
             GrayLevel[1], 
             RGBColor[0.8, 0.9, 0.9]}}}], ")"}], #17, 
     ButtonBox[
      GraphicsBox[{
        RGBColor[0.8, 0.85, 0.85], 
        EdgeForm[
         RGBColor[0.6, 0.7, 0.7]], 
        RectangleBox[{0, 0}, RoundingRadius -> Offset[2.5]], 
        InsetBox[
         StyleBox[
         "\[ScriptCapitalS]", Control`NonlinearModelsDump`LineColor -> 
          GrayLevel[0], Control`NonlinearModelsDump`FrontFaceColor -> 
          GrayLevel[0], Control`NonlinearModelsDump`BackFaceColor -> 
          GrayLevel[0], GraphicsColor -> GrayLevel[0], FontSize -> 12, 
          FontColor -> GrayLevel[0]], {0.5, 0.5}]}, ImageSize -> 20], 
      ButtonFunction :> Control`Typesetting`SystemsModelTypesetToggle[
        ButtonNotebook[], FE`CMObj], Evaluator -> Automatic, Appearance -> 
      None], MultilineFunction -> None], 
    EventHandlerTag[{"MouseEntered" :> {FE`CMObj = MathLink`CallFrontEnd[
          FrontEnd`Value[
           FEPrivate`Self[]]]}, PassEventsDown -> True, PassEventsUp -> 
      True}]]& ),
  InterpretationFunction->(RowBox[{"StateSpaceModel", "[", 
     RowBox[{"{", 
       RowBox[{"{", 
         RowBox[{"{", 
           TemplateSlotSequence[{1, 3}, ","], "}"}], ",", 
         RowBox[{"{", 
           TemplateSlotSequence[{5, 7}, ","], "}"}], ",", 
         RowBox[{"{", 
           TemplateSlotSequence[{9, 11}, ","], "}"}], "}"}], ",", 
       RowBox[{"{", 
         RowBox[{"{", 
           TemplateSlotSequence[{4, 4}, ","], "}"}], ",", 
         RowBox[{"{", 
           TemplateSlotSequence[{8, 8}, ","], "}"}], ",", 
         RowBox[{"{", 
           TemplateSlotSequence[{12, 12}, ","], "}"}], "}"}], ",", 
       RowBox[{"{", 
         RowBox[{"{", 
           TemplateSlotSequence[{13, 15}, ","], "}"}], "}"}], ",", 
       RowBox[{"{", 
         RowBox[{"{", 
           TemplateSlotSequence[{16, 16}, ","], "}"}], "}"}], "}"}], ",", 
     "SamplingPeriod", "->", 
     RowBox[{#17}], ",", "SystemsModelLabels", "->", "None", "]"}]& ),
  Tooltip->StateSpaceModel]], "Output",
 CellChangeTimes->{{3.6940012799087305`*^9, 3.694001299628702*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ObservableModelQ", "[", "systeem3", "]"}]], "Input",
 CellChangeTimes->{{3.693999341063758*^9, 3.693999341741826*^9}, {
  3.69400130281402*^9, 3.6940013085605955`*^9}}],

Cell[BoxData[
 TemplateBox[{
  "LyapunovSolve","meig",
   "\"Matrix with multiple eigenvalues encountered. The solution may be \
inaccurate or may not exist.\"",2,223,46,17607212627329856836,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.694001309088648*^9}],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{3.6940013090906477`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"S", " ", "=", " ", 
    RowBox[{"ObservabilityMatrix", "[", "systeem3", "]"}]}], ")"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.6940017766253967`*^9, 3.6940017927630105`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "2"},
     {"0.002`", "0.`", 
      RowBox[{"-", "0.02`"}]},
     {
      RowBox[{"-", "0.0002`"}], "0.`", "0.0002`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.694001793915126*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"T2", " ", "=", " ", 
    RowBox[{"Transpose", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"S", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"S", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "3"}], "]"}], "]"}], ",", 
       RowBox[{"Cross", "[", 
        RowBox[{
         RowBox[{"S", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"S", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "3"}], "]"}], "]"}]}], "]"}]}], "}"}], "]"}]}],
    ")"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.6940017985405884`*^9, 3.6940018348022137`*^9}, {
  3.6940019210068336`*^9, 3.694001933660099*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "2", 
      RowBox[{"-", "3.6000000000000003`*^-6"}]},
     {"0.002`", 
      RowBox[{"-", "0.02`"}], 
      RowBox[{"-", "0.0004`"}]},
     {
      RowBox[{"-", "0.0002`"}], "0.0002`", 
      RowBox[{"-", "0.004`"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.694001926094342*^9, 3.694001933903123*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"AT3", " ", "=", " ", 
   RowBox[{"T2", ".", "A2", ".", 
    RowBox[{"Inverse", "[", "T2", "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.694001837849519*^9, 3.69400188187092*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"A22", " ", "=", " ", 
  RowBox[{"AT3", "[", 
   RowBox[{"[", 
    RowBox[{
     RowBox[{"2", ";;", "3"}], ",", 
     RowBox[{"2", ";;", "3"}]}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6940018937021036`*^9, 3.694001904959229*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.08940586976558962`"}], ",", "0.007941302344104062`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.005940588760517927`", ",", 
     RowBox[{"-", "0.010594112394820753`"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6940019055432873`*^9, 3.6940019376885014`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Eigenvalues", "[", "A22", "]"}]], "Input",
 CellChangeTimes->{{3.6940019105837917`*^9, 3.694001945221255*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "0.08999998216041037`"}], ",", 
   RowBox[{"-", "0.01`"}]}], "}"}]], "Output",
 CellChangeTimes->{3.694001911909924*^9, 3.6940019457393064`*^9}]
}, Open  ]]
},
WindowSize->{778, 840},
WindowMargins->{{567, Automatic}, {57, Automatic}},
FrontEndVersion->"11.0 for Microsoft Windows (64-bit) (July 28, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 835, 26, 69, "Input"],
Cell[CellGroupData[{
Cell[1418, 50, 614, 17, 30, "Input"],
Cell[2035, 69, 769, 23, 49, "Output"]
}, Open  ]],
Cell[2819, 95, 985, 26, 107, "Input"],
Cell[CellGroupData[{
Cell[3829, 125, 1115, 30, 69, "Input"],
Cell[4947, 157, 195, 5, 30, "Output"],
Cell[5145, 164, 143, 4, 30, "Output"],
Cell[5291, 170, 141, 4, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5469, 179, 403, 11, 30, "Input"],
Cell[5875, 192, 318, 8, 30, "Output"]
}, Open  ]],
Cell[6208, 203, 978, 24, 240, "Input"],
Cell[CellGroupData[{
Cell[7211, 231, 1263, 40, 88, "Input"],
Cell[8477, 273, 759, 22, 77, "Output"],
Cell[9239, 297, 631, 19, 77, "Output"],
Cell[9873, 318, 658, 19, 77, "Output"],
Cell[10534, 339, 628, 19, 77, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11199, 363, 249, 5, 30, "Input"],
Cell[11451, 370, 3970, 89, 120, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15458, 464, 135, 2, 30, "Input"],
Cell[15596, 468, 211, 6, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15844, 479, 143, 2, 30, "Input"],
Cell[15990, 483, 282, 6, 21, "Message"],
Cell[16275, 491, 74, 1, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16386, 497, 236, 6, 30, "Input"],
Cell[16625, 505, 785, 21, 77, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17447, 531, 744, 22, 50, "Input"],
Cell[18194, 555, 766, 21, 77, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18997, 581, 796, 24, 69, "Input"],
Cell[19796, 607, 878, 25, 79, "Output"],
Cell[20677, 634, 659, 19, 77, "Output"],
Cell[21339, 655, 949, 26, 77, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22325, 686, 1124, 35, 88, "Input"],
Cell[23452, 723, 661, 19, 77, "Output"],
Cell[24116, 744, 769, 22, 77, "Output"],
Cell[24888, 768, 629, 19, 77, "Output"],
Cell[25520, 789, 631, 19, 77, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26188, 813, 133, 2, 30, "Input"],
Cell[26324, 817, 211, 6, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26572, 828, 709, 21, 50, "Input"],
Cell[27284, 851, 982, 27, 84, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28303, 883, 678, 18, 30, "Input"],
Cell[28984, 903, 423, 9, 39, "Message"],
Cell[29410, 914, 282, 8, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29729, 927, 852, 25, 107, "Input"],
Cell[30584, 954, 693, 19, 60, "Output"],
Cell[31280, 975, 668, 19, 60, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31985, 999, 249, 5, 30, "Input"],
Cell[32237, 1006, 3787, 85, 103, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36061, 1096, 181, 4, 30, "Input"],
Cell[36245, 1102, 123, 2, 30, "Output"]
}, Open  ]],
Cell[36383, 1107, 722, 20, 107, "Input"],
Cell[CellGroupData[{
Cell[37130, 1131, 547, 15, 69, InheritFromParent],
Cell[37680, 1148, 3506, 78, 86, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41223, 1231, 192, 3, 30, "Input"],
Cell[41418, 1236, 283, 6, 21, "Message"],
Cell[41704, 1244, 76, 1, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41817, 1250, 244, 6, 30, "Input"],
Cell[42064, 1258, 728, 21, 77, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[42829, 1284, 797, 23, 50, "Input"],
Cell[43629, 1309, 847, 24, 79, "Output"]
}, Open  ]],
Cell[44491, 1336, 217, 5, 30, "Input"],
Cell[CellGroupData[{
Cell[44733, 1345, 262, 7, 30, "Input"],
Cell[44998, 1354, 367, 10, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45402, 1369, 134, 2, 30, "Input"],
Cell[45539, 1373, 200, 5, 63, "Output"]
}, Open  ]]
}
]
*)

